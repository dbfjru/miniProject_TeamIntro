<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>자기소개페이지</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./CSS/KMS.css" />
</head>


<body>
    <header class="mytitle">
        <h1>This is Us</h1>
    </header>
        <div id="card" class="row row-cols-1 row-cols-md-3 g-1">
                <div  class="card">
                    <img src="img\img1.jpeg" class="card-img-top" alt="...">

                    <div class="card-body">
                        <h5 class="card-title">김민상</h5>
                        <p class="underline"></p>
                        <p class="card-text" style="text-align: center;">blog</p>
                        <a href="https://kiwimel0n-study.tistory.com/" target="_blank">https://kiwimel0n-study.tistory.com/</a>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <p>MBTI : INTJ</p>
                            <p>좋아하는 색 : 청녹색</p>
                            <p>좋아하는 운동 : 걷기, 농구</p>
                            <p>좋아하는 책 : 종이여자</p>
                            <p>좋아하는 차 : 자몽허니블랙티</p>
                        </li>
                        <li class="list-group-item">
                            <p>객관적으로 살펴본 자신의 장점</p>
                            <a>자신을 객관적으로 바라볼 수 있습니다.</a>
                        </li>
                        <li class="list-group-item">
                            <p>자신의 스타일 협업 스타일 소개</p>
                            <a>수용할 수 있는대로 최대한 맞춰보는 스타일 입니다.</a>
                        </li>
                    </ul>
                    <div class="card-body">

                    </div>
                </div>
        </div>
    <div class="mybtn">
        <!-- Button trigger modal -->
        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
            자기소개 추가 입력하기
        </button>

        <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">자기소개 입력</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="mb-3">
                                <label for="image" class="form-label">프로필사진</label>
                                <input type="text" class="form-control" id="image" aria-describedby="emailHelp">
                            </div>
                            <div class="mb-3">
                                <label for="name" class="form-label">이름</label>
                                <input type="text" class="form-control" id="name" aria-describedby="emailHelp">
                            </div>
                            <div class="mb-3">
                                <label for="blogadd" class="form-label">블로그 주소</label>
                                <input type="text" class="form-control" id="blogadd">
                            </div>
                            <div class="mb-3">
                                <label for="mbti" class="form-label">MBTI</label>
                                <input type="text" class="form-control" id="mbti">
                            </div>
                            <div class="mb-3">
                                <label for="favcolor" class="form-label">좋아하는 색</label>
                                <input type="text" class="form-control" id="favcolor">
                            </div>
                            <div class="mb-3">
                                <label for="exercise" class="form-label">좋아하는 운동</label>
                                <input type="text" class="form-control" id="exercise">
                            </div>
                            <div class="mb-3">
                                <label for="book" class="form-label">좋아하는 책</label>
                                <input type="text" class="form-control" id="book">
                            </div>
                            <div class="mb-3">
                                <label for="tea" class="form-label">좋아하는 차</label>
                                <input type="text" class="form-control" id="tea">
                            </div>
                            <div class="mb-3">
                                <label for="postivepoint" class="form-label">객관적으로 살펴본 자신의 장점</label>
                                <input type="text" class="form-control" id="postivepoint">
                            </div>
                            <div class="mb-3">
                                <label for="collastyle" class="form-label">자신의 스타일 협업 스타일 소개</label>
                                <input type="text" class="form-control" id="collastyle">
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">뒤로가기</button>
                        <button id="postingbtn" type="button" class="btn btn-primary">적용하기</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
</body>
<script type="module">
    // Firebase SDK 라이브러리 가져오기
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
    import { collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
    import { getDocs } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";


    // Firebase 구성 정보 설정
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
        apiKey: "AIzaSyCKBPV6LllVN2NVqtxxKoWpIB7pWDnaXv0",
        authDomain: "sparta-2a1c5.firebaseapp.com",
        projectId: "sparta-2a1c5",
        storageBucket: "sparta-2a1c5.appspot.com",
        messagingSenderId: "8463539243",
        appId: "1:8463539243:web:57296d1eedba1133ce1e6e",
        measurementId: "G-YTDK6THK1W"
    };

    // Firebase 인스턴스 초기화
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    $('#postingbtn').click(async function () {
        let image = $('#image').val();
        let name = $('#name').val();
        let blogadd = $('#blogadd').val();
        let mbti = $('#mbti').val();
        let favcolor = $('#favcolor').val();
        let exercise = $('#exercise').val();
        let book = $('#book').val();
        let tea = $('#tea').val();
        let postivepoint = $('#postivepoint').val();
        let collastyle = $('#collastyle').val();

        let doc = {
            'image': image,
            'name': name,
            'blogadd': blogadd,
            'mbti': mbti,
            'favcolor': favcolor,
            'exercise': exercise,
            'book': book,
            'tea': tea,
            'postivepoint': postivepoint,
            'collastyle': collastyle
        };
        await addDoc(collection(db, "profile"), doc);
        alert('저장 완료!');
        window.location.reload();
    })

    let docs = await getDocs(collection(db, "profile"));
    docs.forEach((doc) => {
        let row = doc.data();
        console.log(row);

        let image = row['image'] || '';
        let name = row['name'] || '';
        let blogadd = row['blogadd'] || '';
        let mbti = row['mbti'] || '';
        let favcolor = row['favcolor'] || '';
        let exercise = row['exercise'] || '';
        let book = row['book'] || '';
        let tea = row['tea'] || '';
        let postivepoint = row['postivepoint'] || '';
        let collastyle = row['collastyle'] || '';


        let temp_html = `
        <div class="row-cols-1 row-cols-md-5 g-4">        
            <div class="card">
                <img src="${image}" class="card-img-top" alt="...">

                <div class="card-body">
                    <h5 class="card-title">${name}</h5>
                    <p class="underline"></p>
                    <p class="card-text" style="text-align: center;">blog</p>
                    <p class="card-text" style="text-align: center;">${blogadd}</p>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                    <p>MBTI : ${mbti}</p>
                    <p>좋아하는 색 : ${favcolor}</p>
                    <p>좋아하는 운동 : ${exercise}</p>
                    <p>좋아하는 책 : ${book}</p>
                    <p>좋아하는 차 : ${tea}</p>
                </li>
                <li class="list-group-item">
                    <p>객관적으로 살펴본 자신의 장점</p>
                    <a>${postivepoint}</a>
                </li>
                <li class="list-group-item">
                    <p>자신의 스타일 협업 스타일 소개</p>
                    <a>${collastyle}</a>
                </li>
                </ul>
                    <div class="card-body">

                    </div>
                </div>
            </div>
        </div>`;
        $('#card').append(temp_html);
    });

    function openclose() {
        $('#postingbox').toggle();
    }
</script>

</html>